(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      8705,        287]
NotebookOptionsPosition[      7518,        244]
NotebookOutlinePosition[      7878,        260]
CellTagsIndexPosition[      7835,        257]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7054494028967667`*^9, 3.70544941131828*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<com-dblp.ungraph.txt\>\"", ",", "\"\<Data\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"communities", "=", " ", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<com-dblp.top5000.cmty.txt\>\"", ",", "\"\<Data\>\""}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7054494189804287`*^9, 3.705449424926745*^9}, {
  3.705449491411089*^9, 3.705449533561963*^9}, {3.7054495642676497`*^9, 
  3.705449589348955*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"communities", " ", "=", " ", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ToExpression", "@", 
       RowBox[{"StringSplit", "@", "#"}]}], "&"}], ",", "communities"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705449636477458*^9, 3.7054496889133053`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TakeLargest", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{"Length", ",", "communities"}], "]"}], ",", "5"}], "]"}]], "Input",\

 CellChangeTimes->{{3.705449553728097*^9, 3.705449557904117*^9}, {
  3.705449612261074*^9, 3.705449628070272*^9}, {3.705449708514447*^9, 
  3.7054497218947563`*^9}, {3.705450295651395*^9, 3.705450296976301*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7556", ",", "5953", ",", "4646", ",", "4194", ",", "3458"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.705449558217346*^9, {3.705449607289892*^9, 3.705449629881155*^9}, {
   3.705449701386465*^9, 3.7054497222632313`*^9}, 3.705450297749239*^9, 
   3.705454722380085*^9, 3.7055340942047653`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"top5", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"communities", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", "#"}], "\[GreaterEqual]", " ", 
       RowBox[{
        RowBox[{"TakeLargest", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{"Length", ",", "communities"}], "]"}], ",", "5"}], "]"}], 
        "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}], "&"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.705450303547329*^9, 3.705450358226726*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nodes", "=", 
   RowBox[{"DeleteDuplicates", "@", 
    RowBox[{"Flatten", "[", "top5", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705450345813493*^9, 3.705450461212193*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nodesA", "=", 
   RowBox[{"Association", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[Rule]", "1"}], "&"}], ",", "nodes"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.705455357018579*^9, 3.705455390757465*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"findNodes", "[", "i_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"MissingQ", "[", 
     RowBox[{"nodesA", "[", "i", "]"}], "]"}], ",", "False", ",", "True"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7054553928711433`*^9, 3.705455476703891*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subset", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"data", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"findNodes", "[", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "&&", " ", 
       RowBox[{"findNodes", "[", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.70545475154397*^9, 3.7054547710527267`*^9}, {
  3.70545528429533*^9, 3.705455291073262*^9}, {3.7054555184926357`*^9, 
  3.705455552467534*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"edges", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[UndirectedEdge]", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "&"}], ",", "subset"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.705455645563552*^9, 3.705455646966783*^9}, {
  3.705455678908596*^9, 3.7054557010849257`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"Graph", "[", "edges", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7054557083274403`*^9, 3.7054557181490183`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"groups", "=", 
   RowBox[{"ConnectedComponents", "[", "g", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705455722583831*^9, 3.705455739712617*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Export", "[", 
  RowBox[{"\"\<top5CommunitiesEdges.csv\>\"", ",", "subset"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<top5Communities.txt\>\"", ",", "top5"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7054557770492373`*^9, 3.705455846298183*^9}, 
   3.705455883521537*^9}],

Cell[BoxData["\<\"top5CommunitiesEdges.csv\"\>"], "Output",
 CellChangeTimes->{
  3.7054558496593943`*^9, 3.7054558855859423`*^9, {3.705534149005857*^9, 
   3.705534173111271*^9}}],

Cell[BoxData["\<\"top5Communities.txt\"\>"], "Output",
 CellChangeTimes->{
  3.7054558496593943`*^9, 3.7054558855859423`*^9, {3.705534149005857*^9, 
   3.7055341731378098`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"part", "=", 
   RowBox[{"FindGraphPartition", "[", 
    RowBox[{"g", ",", "5"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705455912944261*^9, 3.705455923930402*^9}, {
  3.705456009668228*^9, 3.7054560284848423`*^9}, {3.705456586301764*^9, 
  3.705456597490158*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "@", 
  RowBox[{"(", 
   RowBox[{"Length", "/@", "part"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.7054568205898027`*^9, 3.705456837069862*^9}}],

Cell[BoxData["24493"], "Output",
 CellChangeTimes->{{3.705456824004548*^9, 3.705456837535907*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"inter", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Length", "@", 
      RowBox[{"Intersection", "[", 
       RowBox[{
        RowBox[{"part", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"top5", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.705456841553377*^9, 3.7054569344953327`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  FractionBox[
   RowBox[{"Total", "@", 
    RowBox[{"(", 
     RowBox[{"Max", "/@", "inter"}], ")"}]}], 
   RowBox[{"Total", "@", 
    RowBox[{"(", 
     RowBox[{"Length", "/@", "part"}], ")"}]}]], "]"}]], "Input",
 CellChangeTimes->{{3.705456928272697*^9, 3.705456969411018*^9}}],

Cell[BoxData["0.5679990201281999`"], "Output",
 CellChangeTimes->{{3.7054569458288116`*^9, 3.7054569697796783`*^9}}]
}, Open  ]]
},
WindowSize->{808, 423},
WindowMargins->{{Automatic, 155}, {20, Automatic}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 190, 4, 32, "Input"],
Cell[751, 26, 540, 13, 54, "Input"],
Cell[1294, 41, 323, 9, 32, "Input"],
Cell[CellGroupData[{
Cell[1642, 54, 372, 8, 32, "Input"],
Cell[2017, 64, 336, 7, 32, "Output"]
}, Open  ]],
Cell[2368, 74, 562, 17, 32, "Input"],
Cell[2933, 93, 215, 5, 32, "Input"],
Cell[3151, 100, 298, 9, 32, "Input"],
Cell[3452, 111, 302, 8, 32, "Input"],
Cell[3757, 121, 572, 16, 32, "Input"],
Cell[4332, 139, 440, 13, 32, "Input"],
Cell[4775, 154, 174, 4, 32, "Input"],
Cell[4952, 160, 185, 4, 32, "Input"],
Cell[CellGroupData[{
Cell[5162, 168, 329, 7, 54, "Input"],
Cell[5494, 177, 180, 3, 32, "Output"],
Cell[5677, 182, 177, 3, 90, "Output"]
}, Open  ]],
Cell[5869, 188, 307, 7, 32, "Input"],
Cell[CellGroupData[{
Cell[6201, 199, 177, 4, 32, "Input"],
Cell[6381, 205, 98, 1, 32, "Output"]
}, Open  ]],
Cell[6494, 209, 549, 16, 32, "Input"],
Cell[CellGroupData[{
Cell[7068, 229, 315, 9, 53, "Input"],
Cell[7386, 240, 116, 1, 32, "Output"]
}, Open  ]]
}
]
*)

